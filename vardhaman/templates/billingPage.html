{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="csrf-token" content="iL8hUXsdXy71MbOZjq4fWUv4KGPZnJ7k17P7RClL">
    <link rel="icon" href="https://thememakker.com/templates/oreo/hospital/laravel/public/favicon.ico" type="image/x-icon"> 
    <!-- Favicon-->
    <link rel="icon" href="{% static 'images/vardhaman.png' %}" type="image/png" />
    <title>Vardhaman Gruh Udhyog</title>
    <meta name="description" content="Oero Laravel">
    <meta name="author" content="Oero Laravel">

    <link rel="stylesheet" href="{% static 'assets\plugins\bootstrap\css\bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets\plugins\jvectormap\jquery-jvectormap-2.0.3.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets\plugins\morrisjs\morris.min.css' %}">
    <!-- Custom Css -->
    <link rel="stylesheet" href="{% static 'assets\css\main.css' %}">
    <link rel="stylesheet" href="{% static 'assets\css\color_skins.css' %}">
</head>
<style>
    .imageData {
        height: 5rem;
        width: 6rem;
    }
</style>

<body class="theme-purple">
    <!-- Page Loader -->
    <div class="page-loader-wrapper">
        <div class="loader">

            <div class="m-t-30"><img class="zmdi-hc-spin" src="{% static 'assets\images\logo.svg' %}" width="48"
                    height="48" alt="Civil Hospital"></div>
            <p>Please wait...</p>
        </div>
    </div>
    <!-- Overlay For Sidebars -->
    <div class="overlay"></div>
    {% include 'base.html' %} 
    {% include 'left.html' %}
   <section class="content home">
        <div class="block-header">
            <div class="col-lg-3 col-md-3 col-sm-12">
                <h2><img class="navbar-brand" src="{% static 'assets\images\Index-Icons\order.jpg' %}" width="50" style="border-radius: 100px;"/>Billing Page<small class="text-muted">Welcome to Vardhaman Gruh Udhyog</small></h2>
            </div>
        </div>
        <br>
        <div class="body container-fluid">
            <!-- Nav tabs -->
            <!-- Tab panes -->
            <div class="tab-content m-t-10">
                <div class="tab-pane table-responsive active" id="All">
                    <div class="container">
                        <div class="form-container">
                            <form id="productForm" autocomplete='off' class="needs-validation" novalidate enctype="multipart/form-data" action="{% url 'productAddUpdateFunctionality' %}" method="POST"> {% csrf_token %}
                                <div class="form-row">
                                    <div class="col-md-6 mb-3">
                                        <label for="customerName">Customer's Name:</label>
                                        <input type="text" class="form-control" id="customerName" Placeholder='Please Enter Name of Customer' name="customerName" required>
                                        <div class="invalid-feedback">
                                            Please enter a Customer's name.
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="customerNumber">Customer's Contact No:</label>
                                        <input type="text" class="form-control" id="customerNo" maxlength="10" oninput="validateNumeric(this)" Placeholder="Please Enter Customer's Contact Number" name="customerNo"  required>
                                        <div class="invalid-feedback">
                                            Please enter a Customer's Contact Number.
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="col-md-6 mb-3">
                                        <label for="customerEmail">Customer's Email:</label>
                                        <input type="text" class="form-control" id="customerEmail" Placeholder="Please Enter Customer's Email" name="customerEmail">
                                        <div class="invalid-feedback">
                                            Please enter a Customer's Email.
                                        </div>
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="customerAddress">Customer's Address:</label>
                                        <input type="text" class="form-control" id="customerAddress" Placeholder="Please Enter Customer's Address" name="customerAddress"  required>
                                        <div class="invalid-feedback">
                                            Please enter a Customer's Address.
                                        </div>
                                    </div>
                                </div>
                                <hr/>
                                <div class="form-row">
                                    <div class="col-md-12 mb-3">
                                        <label for="ProductSearch">Search Product:</label>
                                        <input type="text" class="form-control searchProduct" id="searchProduct" Placeholder="Search Product Name" name="searchProduct">
                                        <div class="productList" id="productList" hidden>
                                            
                                        </div>
                                    </div>
                                </div>
                                
                                <hr/>
                                <div style="margin: 1rem;"></div>
                                <div class="form-row">
                                    <div class="col-md-12 text-right">
                                        <a href="{% url 'ordersPage' %}" class="btn btn-danger">Cancel</a>
                                        <button type="submit" class="btn btn-success mr-2">{% if productData.id %}Update{% else%}Submit{% endif %}</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Scripts -->
    <script src="{% static 'assets\bundles\libscripts.bundle.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'assets\bundles\vendorscripts.bundle.js' %}"></script>
    <script>
        // return the integer value
        function validateNumeric(input) {
            // Remove non-numeric characters and allow for decimal points
            input.value = input.value.replace(/[^0-9.]/g, '');
        
            // Remove extra decimal points
            input.value = input.value.replace(/\.{2,}/g, '.');
        
            // Remove leading decimal point
            input.value = input.value.replace(/^\./g, '');
        
            // Remove non-leading minus signs
            input.value = input.value.replace(/-+/g, m => (m.length > 1 ? '' : m));
        
            // Remove leading zeros, except for the case where it's the only character
            input.value = input.value.replace(/^0+(?=[^.])/, '');
        }

        jQuery(document).ready(function(){
            // Count the GST price
            jQuery('.searchProduct').on('input', function() {
                const searchValue = jQuery('#searchProduct').val();
                mydata = {name:searchValue, 'csrfmiddlewaretoken': '{{ csrf_token }}'}
                jQuery("#productList").attr("hidden",true)
                if(searchValue.length > 3){
                    jQuery("#productList").html("")
                    $.ajax({
                        url : "{% url 'productSearchByName' %}",
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify(mydata),
                        success: function(response) {
                            jQuery("#productList").html("")
                            // Handle successful response
                            if(response.status === 200){
                                jQuery("#productList").removeAttr("hidden")
                                const dataResponse = response.data
                                if(dataResponse.length !== 0){
                                    $.each(dataResponse, function(i, item){
                                        console.log("Line no 127",item)
                                        jQuery("#productList").append(`<p> ${item.product_name_eng} </p>`);
                                    })
                                }else{
                                    jQuery("#productList").append(`<p>No Product Available</p>`);

                                }
                            }
                        
                            console.log(response.status);
                        },
                        error: function(xhr, status, error) {
                            // Handle error
                            console.error(xhr.responseText);
                        }
                    });
                }
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var form = document.getElementById('productForm');
    
            form.addEventListener('submit', function (event) {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
    
                form.classList.add('was-validated');
            });
        });
    </script>
    <script src="{% static 'assets\bundles\mainscripts.bundle.js' %}"></script>
    <script src="{% static 'assets\bundles\morrisscripts.bundle.js' %}"></script>
    <script src="{% static 'assets\bundles\jvectormap.bundle.js' %}"></script>
    <script src="{% static 'assets\bundles\knob.bundle.js' %}"></script>
    <script src="{% static 'assets\js\pages\index.js' %}"></script>
    <!--Start of Tawk.to Script-->
    <script type="text/javascript">
        var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
        (function () {
            var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
            s1.async = true;
            s1.src = 'https://embed.tawk.to/59f5afbbbb0c3f433d4c5c4c/default';
            s1.charset = 'UTF-8';
            s1.setAttribute('crossorigin', '*');
            s0.parentNode.insertBefore(s1, s0);
        })();
    </script>
    <!--End of Tawk.to Script-->
</body>
</html>